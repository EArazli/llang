doctrine SchemaMonad where {
  mode C;

  modality T : C -> C;

  gen ret(x@C) : [x] -> [T(x)] @C;
  gen join(x@C) : [T(T(x))] -> [T(x)] @C;

  obligation leftUnit(a@C) : [T(a)] -> [T(a)] @C =
    map[T](ret{a}) ; join{a} == id[T(a)]

  obligation rightUnit(a@C) : [T(a)] -> [T(a)] @C =
    ret{T(a)} ; join{a} == id[T(a)]

  obligation assoc(a@C) : [T(T(T(a)))] -> [T(a)] @C =
    map[T](join{a}) ; join{a} == join{T(a)} ; join{a}
}
